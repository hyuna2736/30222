# 1. ê¸°ë³¸ êµ¬ì¡° ì˜ˆì¸¡ ë£° (ë¦¬ìŠ¤íŠ¸ë¡œ ê´€ë¦¬)
helix_formers = ['A', 'L', 'M', 'Q', 'E', 'K', 'H']
sheet_formers = ['V', 'I', 'Y', 'F', 'W', 'T']
coil_formers  = ['G', 'P', 'S', 'D', 'N']

# 2. ìœ ì „ ì§ˆí™˜ ì—°ê´€ ë³€ì´ DB (ë”•ì…”ë„ˆë¦¬ë¡œ ê´€ë¦¬)
disease_db = {
    (6, 'E', 'V'): {
        "name": "ê²¸ìƒì í˜ˆêµ¬ë¹ˆí˜ˆ (Sickle Cell Anemia)",
        "notes": [
            "ì‚°ì†Œ ê³µê¸‰ ë³´ì¥",
            "í†µì¦ ê´€ë¦¬",
            "ê°ì—¼ ì˜ˆë°© êµìœ¡"
        ]
    },
    (117, 'F', 'S'): {
        "name": "ë‚­í¬ì„± ì„¬ìœ ì¦ (Cystic Fibrosis)",
        "notes": [
            "í˜¸í¡ê¸° ê´€ë¦¬",
            "ì˜ì–‘ ê³µê¸‰",
            "ì ì•¡ ë°°ì¶œ ë„ì›€"
        ]
    },
    # ì˜ˆì‹œ: ë” ë§ì€ ë³€ì´ ë°ì´í„° ì¶”ê°€
    (89, 'C', 'Y'): {
        "name": "ìœ ì „ì„± ìœ ë°©ì•” (Hereditary Breast Cancer)",
        "notes": [
            "ì •ê¸°ì ì¸ ìœ ë°©ê²€ì‚¬",
            "ì‹¬ë¦¬ì  ì§€ì› ì œê³µ",
            "ì•” ì˜ˆë°©ì„ ìœ„í•œ ìƒí™œ ìŠµê´€ ê´€ë¦¬"
        ]
    },
    (320, 'R', 'Q'): {
        "name": "ì•Œì¸ í•˜ì´ë¨¸ ë³‘ (Alzheimer's Disease)",
        "notes": [
            "ì¸ì§€ ì¹˜ë£Œ",
            "í™˜ê²½ì  ìš”ì¸ ê´€ë¦¬",
            "ê¸°ì–µë ¥ ê°œì„  í”„ë¡œê·¸ë¨"
        ]
    }
}

# 3. êµ¬ì¡° ì˜ˆì¸¡ í•¨ìˆ˜ (ë¦¬ìŠ¤íŠ¸ ì‚¬ìš©)
def predict_secondary_structure(seq):
    structure = []  # êµ¬ì¡°ë¥¼ ì €ì¥í•  ë¦¬ìŠ¤íŠ¸
    for aa in seq:
        if aa in helix_formers:
            structure.append("H")  # Helix
        elif aa in sheet_formers:
            structure.append("E")  # Sheet
        else:
            structure.append("C")  # Coil
    return ''.join(structure)

# 4. ë³€ì´ ë¹„êµ (ë¦¬ìŠ¤íŠ¸ì™€ íŠœí”Œì„ ì‚¬ìš©)
def compare_sequences(seq1, seq2):
    if len(seq1) != len(seq2):
        raise ValueError("ì„œì—´ ê¸¸ì´ê°€ ë‹¤ë¦…ë‹ˆë‹¤. ë¹„êµí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")

    mutations = []  # ë³€ì´ ìœ„ì¹˜ë¥¼ ì €ì¥í•  ë¦¬ìŠ¤íŠ¸
    for i, (aa1, aa2) in enumerate(zip(seq1, seq2), start=1):
        if aa1 != aa2:
            mutations.append((i, aa1, aa2))  # ë³€ì´ ì •ë³´ë¥¼ íŠœí”Œë¡œ ì €ì¥
    return mutations

# 5. ì§ˆë³‘ ì—°ê´€ í™•ì¸ (ë³€ì´ ì •ë³´ê°€ ì§ˆë³‘ê³¼ ì—°ê²°ë˜ëŠ”ì§€ í™•ì¸)
def check_disease_links(mutations):
    related = []  # ìœ ì „ ì§ˆí™˜ê³¼ ì—°ê´€ëœ ë³€ì´ ì •ë³´ë¥¼ ì €ì¥í•  ë¦¬ìŠ¤íŠ¸
    for pos, orig, mut in mutations:
        key = (pos, orig, mut)  # ë³€ì´ ì •ë³´ë¥¼ íŠœí”Œë¡œ ì €ì¥
        if key in disease_db:
            related.append((pos, disease_db[key]))  # ê´€ë ¨ ì§ˆí™˜ ì •ë³´ë¥¼ ë¦¬ìŠ¤íŠ¸ì— ì €ì¥
    return related

# 6. ê²°ê³¼ ì¶œë ¥ í•¨ìˆ˜ (ë¦¬ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ë³€ì´ ë¹„êµì™€ êµ¬ì¡° ì¶œë ¥)
def print_results(seq1, seq2, struct1, struct2, mutations, disease_links):
    print("\nğŸ”¬ ì›ë³¸ ì„œì—´:     ", seq1)
    print("ğŸ§¬ ë¹„êµ ì„œì—´:     ", seq2)
    print("ğŸ“ˆ êµ¬ì¡° ì˜ˆì¸¡(ì›ë³¸):", struct1)
    print("ğŸ“‰ êµ¬ì¡° ì˜ˆì¸¡(ë¹„êµ):", struct2)

    if mutations:
        print("\nğŸ” ë³€ì´ëœ ìœ„ì¹˜:")
        for pos, orig, mut in mutations:
            print(f" - {pos}ë²ˆì§¸: {orig} â†’ {mut}")

        print("\nğŸ“Œ êµ¬ì¡° ë³€í™” ìœ„ì¹˜:")
        diff = [" " if a == b else "^" for a, b in zip(struct1, struct2)]
        print("                     " + "".join(diff))
    else:
        print("\nâœ… ë‘ ì„œì—´ì€ ì™„ì „íˆ ë™ì¼í•©ë‹ˆë‹¤. ë³€ì´ê°€ ì—†ìŠµë‹ˆë‹¤.")

    if disease_links:
        print("\nâš ï¸ ìœ ì „ ì§ˆí™˜ ì—°ê´€ ë³€ì´ ë°œê²¬:")
        for pos, info in disease_links:
            print(f" - {pos}ë²ˆì§¸ ë³€ì´ â†’ ê´€ë ¨ ì§ˆí™˜: {info['name']}")
            print("   ğŸ©º ê°„í˜¸ ì¤‘ì¬ ì˜ˆì‹œ:")
            for note in info["notes"]:
                print("     â€¢", note)
    else:
        print("\nâœ… í˜„ì¬ê¹Œì§€ ì•Œë ¤ì§„ ìœ ì „ ì§ˆí™˜ê³¼ ê´€ë ¨ëœ ë³€ì´ëŠ” ì—†ìŠµë‹ˆë‹¤.")

# ë©”ì¸ ì‹¤í–‰
if __name__ == "__main__":
    print("ğŸ’¡ ì•„ë¯¸ë…¸ì‚° ì„œì—´ ê¸¸ì´ëŠ” ê°™ì•„ì•¼ í•©ë‹ˆë‹¤.")
    seq1 = input("ğŸ”¡ ì›ë³¸ ì•„ë¯¸ë…¸ì‚° ì„œì—´ì„ ì…ë ¥í•˜ì„¸ìš”: ").strip().upper()
    seq2 = input("ğŸ”¡ ë¹„êµí•  ì•„ë¯¸ë…¸ì‚° ì„œì—´ì„ ì…ë ¥í•˜ì„¸ìš”: ").strip().upper()

    try:
        struct1 = predict_secondary_structure(seq1)
        struct2 = predict_secondary_structure(seq2)
        mutations = compare_sequences(seq1, seq2)
        disease_links = check_disease_links(mutations)

        print_results(seq1, seq2, struct1, struct2, mutations, disease_links)

    except ValueError as e:
        print("âš ï¸ ì˜¤ë¥˜:", e)

